# Groove Sampler - 要件定義書

## 1. 概要

### 1.1. プロジェクト名
Groove Sampler

### 1.2. プロジェクト概要
モバイルブラウザ向けに最適化された、高機能サンプラー＆シーケンサーアプリケーション。ユーザーはマイク録音やファイルインポートを通じて音素材を取り込み、直感的なインターフェースでビートメイキングを行える。特に、高度なグルーヴエンジンによる人間らしいリズムの揺らぎや、ポリリズム作成機能に重点を置く。

### 1.3. 目的
時間や場所を選ばず、誰でも手軽に本格的な音楽制作のアイデアスケッチやビートメイキングを楽しめるプロフェッショナルなツールを提供する。

## 2. ターゲットユーザー
- 外出先や移動中に音楽のアイデアを形にしたい音楽プロデューサー、ビートメーカー。
- モバイル環境で手軽にビートメイキングを始めたい音楽制作の初心者。
- ライブパフォーマンスのシーケンス作成やアイデア出しを行いたいDJ。

## 3. 機能要件

### 3.1. サンプラー機能 (Sample View)
- **音声入力:**
    - [F-001] デバイスのマイクを使用した音声の録音機能。
    - [F-002] 録音開始のトリガーとなる音量スレッショルド（しきい値）設定機能。
    - [F-003] ローカルデバイスからのオーディオファイル（WAV, MP3等）のインポート機能。
- **サンプル管理:**
    - [F-004] 4つのバンク（A, B, C, D）にそれぞれ8個、合計32個のサンプルを保持可能。
    - [F-005] 各サンプルに名前を付ける編集機能。
    - [F-006] サンプルパッド間での設定のコピー＆ペースト機能。
    - [F-007] 編集したサンプルをWAVファイルとしてエクスポートする機能。
- **パラメータ編集:**
    - [F-008] 各サンプルのピッチ（-24 ~ +24 semitones）を調整可能。
    - [F-009] 各サンプルの再生開始位置（Start）を調整可能。
    - [F-010] 各サンプルのディケイ（Decay）/長さを調整可能。
    - [F-011] 各サンプルのボリューム（Volume）を調整可能。

### 3.2. シーケンサー機能 (Seq View)
- **ステップシーケンス:**
    - [F-012] 1サンプルあたり32ステップのシーケンスを作成可能。
    - [F-013] ステップグリッドをタップすることでノートのON/OFFを切り替え。
    - [F-014] シーケンサー再生中に現在のステップを視覚的に表示。
- **パターン管理:**
    - [F-015] 4つのバンクにそれぞれ32個、合計128個のパターンを保持可能。
    - [F-016] 各バンク（トラック）に任意のパターンをアサインして再生可能。
- **ポリリズム/ポリメーターエンジン:**
    - [F-017] 32ステップをPart A（1-16）とPart B（17-32）の2セクションに分割。
    - [F-018] Part AとPart Bでそれぞれ独立したステップ解像度（Rate）を設定可能（例: 16分音符と3連符）。
    - [F-019] Part AとPart Bでそれぞれ独立したステップ長（Length）を設定可能（例: 16ステップと12ステップ）。
    - [F-020] Part AとPart Bのループ回数をプリセットから選択し、複雑なシーケンスを構成可能。

### 3.3. グルーヴ機能 (Groove View)
- [F-021] 32種類のグルーヴ・テンプレート（ストレート, 各種スウィング, MPC, SP-1200など）から選択可能。
- [F-022] グルーヴの適用度（Depth）を-100%から+100%まで調整し、タイミングの揺らぎをコントロール可能。

### 3.4. ミキサー機能 (Mixer View)
- [F-023] 4つのサンプルバンク（トラック）それぞれに対応したボリュームフェーダーを実装。
- [F-024] 各トラックの音量バランスを直感的に調整可能。

### 3.5. プロジェクト管理機能 (Project View)
- [F-025] 現在のアプリケーションの状態（全サンプルのデータ、シーケンス、設定）を一つのプロジェクトとして保存可能。
- [F-026] 保存したプロジェクトの一覧を表示し、任意のプロジェクトを読み込む機能。
- [F-027] 不要になったプロジェクトを削除する機能。

## 4. 非機能要件

### 4.1. パフォーマンス
- **レイテンシー:** Web Audio APIを駆使し、オーディオ再生・録音の遅延を最小限に抑える。
- **UI応答性:** オーディオ処理がUIスレッドをブロックしないように設計し、スムーズな操作性を確保する。

### 4.2. 互換性
- 最新版の主要なモバイルおよびデスクトップブラウザ（Google Chrome, Safari, Firefox）で全ての機能が正常に動作すること。

### 4.3. ユーザーインターフェース (UI/UX)
- モバイルデバイスでの操作に最適化された、タッチフレンドリーなレスポンシブデザインを採用する。
- 視認性が高く、現在の状態（再生中、録音中、アクティブな要素など）が直感的に理解できるデザイン。

### 4.4. データ永続化
- プロジェクトデータはブラウザのIndexedDBに保存され、ユーザーがデータをクリアしない限り永続する。

## 5. 技術スタック
- **主要言語:** TypeScript
- **フレームワーク:** React
- **スタイリング:** Tailwind CSS
- **オーディオ処理:** Web Audio API
- **データベース:** Dexie.js (IndexedDB Wrapper)
- **実行環境:** AI Studio (esbuild)
